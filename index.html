<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport"
        content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
  <meta name="theme-color" content="#00B050" />
  <link rel="manifest" href="./manifest.json" />
  <link rel="icon" sizes="192x192" href="./icon-192.png" />
  <title>NHë†í˜‘ì€í–‰</title>

  <style>
    /* ---------- ê³µí†µ ---------- */
    * { margin:0; padding:0; box-sizing:border-box; -webkit-tap-highlight-color:transparent; }
    body { font-family:-apple-system, BlinkMacSystemFont, "Apple SD Gothic Neo", "Segoe UI", sans-serif; background:#f6f7f9; color:#111; }
    button { font-family:inherit; }
    .wrap { min-height:100vh; display:flex; flex-direction:column; }
    .container { flex:1; padding:16px; }

    .hidden { display:none !important; }

    .bar {
      position:sticky; top:0; z-index:10;
      display:flex; align-items:center; justify-content:space-between;
      padding:14px 16px; border-bottom:1px solid #eee; background:#fff;
    }
    .bar-title { font-size:18px; font-weight:800; }
    .icon-btn { border:0; background:none; padding:6px; font-size:20px; color:#555; }

    /* ---------- ì¹´ë“œ/ì„¹ì…˜ ---------- */
    .section-title { font-size:18px; font-weight:800; margin:12px 4px 10px; }
    .card {
      background:#fff; border-radius:16px; box-shadow:0 1px 3px rgba(0,0,0,0.06);
      padding:14px; margin-bottom:14px;
    }
    .pill {
      display:inline-flex; align-items:center; gap:4px;
      padding:4px 8px; border-radius:14px; font-size:12px;
    }
    .pill-gray { background:#f1f3f5; color:#666; border:1px solid #e5e7ea; }

    .row { display:flex; align-items:center; justify-content:space-between; gap:8px; }
    .muted { color:#6b7280; }
    .strong { font-weight:800; }

    /* ---------- í™ˆ: ë°°ë„ˆ ---------- */
    .banner {
      display:flex; align-items:center; gap:12px;
      background:#fff; border-radius:16px; padding:14px;
      box-shadow:0 1px 3px rgba(0,0,0,0.06); margin-bottom:16px;
    }
    .banner-emoji {
      width:44px; height:44px; border-radius:50%;
      background:#fff7cc; display:flex; align-items:center; justify-content:center;
      font-size:22px;
    }
    .banner-title { font-size:15px; font-weight:700; }
    .banner-sub { font-size:12px; color:#666; margin-top:2px; }

    /* ---------- í™ˆ: ê³„ì¢Œ ì¹´ë“œ ---------- */
    .acct-title { font-size:16px; font-weight:800; margin:2px 0 6px; }
    .acct-num { font-size:13px; color:#6b7280; }
    .acct-footer { display:flex; gap:10px; margin-top:12px; }
    .chip-btn {
      border:1px solid #e5e7ea; background:#fff; color:#333; font-weight:700;
      padding:10px 14px; border-radius:999px; font-size:14px;
    }
    .acct-touch { cursor:pointer; }

    /* ---------- í•˜ë‹¨ íƒ­ ---------- */
    .tabbar {
      position:sticky; bottom:0; z-index:10;
      display:flex; justify-content:space-around; align-items:center;
      padding:10px 8px; background:#fff; border-top:1px solid #e5e7ea;
    }
    .tab { display:flex; flex-direction:column; align-items:center; gap:6px; color:#888; font-size:11px; }
    .tab.active { color:#00B050; font-weight:800; }
    .dot { width:8px; height:8px; border-radius:999px; background:currentColor; }

    /* ---------- ê±°ë˜ë‚´ì—­ ---------- */
    .sub-row { font-size:12px; color:#6b7280; }
    .filter-line {
      display:flex; align-items:center; justify-content:space-between;
      font-size:13px; color:#6b7280; padding:10px 0; border-bottom:1px solid #eee;
    }

    .txn-card { background:#fff; border-radius:16px; overflow:hidden; box-shadow:0 1px 3px rgba(0,0,0,0.06); }
    .txn-head { display:flex; align-items:center; justify-content:space-between; padding:14px 16px; border-bottom:1px solid #f0f0f0; }
    .txn-title { font-size:15px; font-weight:800; }
    .txn-list .item { display:flex; align-items:center; justify-content:space-between; gap:12px; padding:14px 16px; border-bottom:1px solid #f0f0f0; }
    .txn-list .item:last-child { border-bottom:none; }
    .tname { font-weight:700; }
    .tdate { font-size:12px; color:#9aa1a9; margin-top:4px; }
    .tamt { font-weight:800; font-size:15px; color:#f44336; text-align:right; }
    .tbal { font-size:12px; color:#9aa1a9; text-align:right; margin-top:2px; }

    /* ---------- ëª¨ë‹¬ ---------- */
    .modal {
      position:fixed; inset:0; display:none; align-items:flex-end; background:rgba(0,0,0,0.45); z-index:50;
    }
    .modal.show { display:flex; }
    .sheet { width:100%; background:#fff; border-radius:20px 20px 0 0; max-height:80vh; overflow:auto; padding:18px; }
    .sheet-title { font-size:17px; font-weight:800; }
    .sheet-close { border:0; background:none; font-size:26px; color:#666; }

    .grid { display:grid; gap:8px; }
    .grid-2 { grid-template-columns:repeat(2, 1fr); }
    .grid-3 { grid-template-columns:repeat(3, 1fr); }
    .grid-4 { grid-template-columns:repeat(4, 1fr); }
    .opt-btn {
      padding:12px; border:1px solid #e5e7ea; border-radius:10px; background:#fff;
      font-size:14px; text-align:center; cursor:pointer;
    }
    .opt-btn.selected { border:2px solid #00B050; background:#f0fff4; color:#00B050; font-weight:800; }
    .submit {
      width:100%; padding:14px; border:0; border-radius:12px; background:#00B050; color:#fff; font-weight:800; margin-top:14px;
    }

    /* ---------- ì„¤ì¹˜ ë²„íŠ¼(ì„ íƒ) ---------- */
    #installBtn {
      position:fixed; right:14px; bottom:86px; z-index:60;
      display:none; padding:12px 14px; border:0; border-radius:12px; background:#00B050; color:#fff; font-weight:800;
      box-shadow:0 4px 10px rgba(0,0,0,0.15);
    }
  </style>
</head>

<body>
<div class="wrap">

  <!-- ############### í™ˆ í™”ë©´ ############### -->
  <header class="bar" id="homeBar">
    <div class="bar-title">ì£¼ì„±ê´‘ë‹˜</div>
    <button class="icon-btn" aria-label="ì•Œë¦¼">â‹¯</button>
  </header>

  <main class="container" id="homeView" role="main" aria-label="í™ˆ">
    <!-- ë°°ë„ˆ -->
    <div class="banner">
      <div class="banner-emoji">ğŸ¥š</div>
      <div>
        <div class="banner-title">100% ë‹¹ì²¨ ì˜¬ì›ë£°ë ›! ë§¤ì¼ ìµœëŒ€ 5ë§ŒP</div>
        <div class="banner-sub">ì˜¤ëŠ˜ì€ ì–¼ë§ˆ? ì§€ê¸ˆ í™•ì¸í•˜ì„¸ìš”!</div>
      </div>
    </div>

    <!-- ë‚´ ê³„ì¢Œ -->
    <div class="section-title">ë‚´ ê³„ì¢Œ</div>

    <div class="card acct-touch" id="accountCard" tabindex="0" role="button"
         aria-label="NHí˜ì´ëª¨ì•„í†µì¥ ê±°ë˜ë‚´ì—­ ë³´ê¸°">
      <!-- í•œë„ì œí•œê³„ì¢Œ ë±ƒì§€ -->
      <span class="pill pill-gray" style="margin-bottom:6px;">í•œë„ì œí•œê³„ì¢Œ</span>

      <div class="acct-title">NHí˜ì´ëª¨ì•„í†µì¥(ë¹„ëŒ€ë©´ì‹¤ëª…í™•ì¸)</div>
      <div class="acct-num">302-1934-2120-51</div>

      <div class="acct-footer" aria-hidden="true">
        <button type="button" class="chip-btn">ATMì¶œê¸ˆ</button>
        <button type="button" class="chip-btn">ì±„ìš°ê¸°</button>
        <button type="button" class="chip-btn">ë³´ë‚´ê¸°</button>
      </div>
    </div>

    <!-- ë‚´ ëª¨ì„ (ìƒ˜í”Œ) -->
    <div class="section-title">ë‚´ ëª¨ì„</div>
    <div class="card">
      <div class="row">
        <div>
          <div class="strong" style="margin-bottom:4px;">NHì˜¬ì›ëª¨ì„ì„œë¹„ìŠ¤</div>
          <div class="muted" style="font-size:12px;">í•¨ê»˜í•˜ëŠ” ìˆœê°„ì´ ë” ì‰½ê³  ì¦ê±°ì›Œì§€ëŠ”</div>
        </div>
        <button type="button" class="chip-btn">ë‚´ ìì‚° í™•ì¸</button>
      </div>
    </div>
  </main>

  <!-- í•˜ë‹¨ íƒ­ -->
  <nav class="tabbar" aria-label="íƒ­ë°”">
    <div class="tab active"><span class="dot"></span><span>í™ˆ</span></div>
    <div class="tab"><span class="dot"></span><span>ìƒí’ˆëª°</span></div>
    <div class="tab"><span class="dot"></span><span>MY</span></div>
    <div class="tab"><span class="dot"></span><span>P</span></div>
    <div class="tab"><span class="dot"></span><span>ìƒí™œí˜œíƒ</span></div>
  </nav>

  <!-- ############### ê±°ë˜ë‚´ì—­ í™”ë©´ ############### -->
  <header class="bar hidden" id="txnBar">
    <button class="icon-btn" id="backBtn" aria-label="ë’¤ë¡œ">â€¹</button>
    <div class="bar-title">ê±°ë˜ë‚´ì—­ì¡°íšŒ</div>
    <button class="icon-btn" aria-hidden="true">â˜°</button>
  </header>

  <main class="container hidden" id="txnView" role="main" aria-label="ê±°ë˜ë‚´ì—­ ì¡°íšŒ">
    <!-- ê³„ì¢Œ íƒ€ì´í‹€ -->
    <div class="card" style="margin-top:0;">
      <div class="strong" style="font-size:16px; margin-bottom:6px;">NHë†í˜‘ 302-1934-2120-51</div>
      <div class="sub-row">NHí˜ì´ëª¨ì•„í†µì¥(ë¹„ëŒ€ë©´ì‹¤ëª…í™•ì¸)</div>
    </div>

    <!-- ê¸°ê°„ ì„ íƒ ë¼ì¸ (ì¢Œ:ê¸°ê°„í‘œì‹œ / ìš°:í•„í„°ì•„ì´ì½˜) -->
    <div class="filter-line">
      <div id="periodLabel">2025.10.31 ~ 2025.11.07 Â· ì „ì²´ Â· ìµœì‹ ìˆœ</div>
      <button class="icon-btn" id="openFilter" aria-label="ì¡°íšŒê¸°ê°„ ì„¤ì •">âš™ï¸</button>
    </div>

    <!-- ê±°ë˜ ì¹´ë“œ -->
    <div class="txn-card" style="margin-top:12px;">
      <div class="txn-head">
        <div class="txn-title">ê±°ë˜ë‚´ì—­</div>
        <div class="muted" style="font-size:12px;">í˜„ì¬ì”ì•¡ <span id="currentBal" class="strong">1,616,380ì›</span></div>
      </div>
      <div class="txn-list" id="txnList"></div>
    </div>
  </main>

  <!-- ############### ê¸°ê°„/ì •ë ¬/êµ¬ë¶„ ëª¨ë‹¬ ############### -->
  <div class="modal" id="filterModal" aria-hidden="true">
    <div class="sheet">
      <div class="row" style="margin-bottom:14px;">
        <div class="sheet-title">ì¡°íšŒê¸°ê°„ ì„ íƒ</div>
        <button class="sheet-close" id="closeFilter" aria-label="ë‹«ê¸°">Ã—</button>
      </div>

      <!-- ê¸°ê°„ -->
      <div style="margin-bottom:14px;">
        <div class="muted" style="font-size:13px; margin-bottom:8px;">ê¸°ê°„</div>
        <div class="grid grid-4">
          <button class="opt-btn selected" data-period="1week">1ì£¼ì¼</button>
          <button class="opt-btn" data-period="1month">1ê°œì›”</button>
          <button class="opt-btn" data-period="3months">3ê°œì›”</button>
          <button class="opt-btn" data-period="1year">1ë…„</button>
        </div>
        <div id="dateRangeText" class="muted" style="margin-top:10px; font-size:13px;">
          2025.10.31 ~ 2025.11.07
        </div>
      </div>

      <!-- ì •ë ¬ -->
      <div style="margin-bottom:14px;">
        <div class="muted" style="font-size:13px; margin-bottom:8px;">ì •ë ¬</div>
        <div class="grid grid-2">
          <button class="opt-btn selected" data-sort="latest">ìµœì‹ ìˆœ</button>
          <button class="opt-btn" data-sort="oldest">ê³¼ê±°ìˆœ</button>
        </div>
      </div>

      <!-- êµ¬ë¶„ -->
      <div style="margin-bottom:4px;">
        <div class="muted" style="font-size:13px; margin-bottom:8px;">êµ¬ë¶„</div>
        <div class="grid grid-3">
          <button class="opt-btn selected" data-type="all">ì „ì²´</button>
          <button class="opt-btn" data-type="deposit">ì…ê¸ˆ</button>
          <button class="opt-btn" data-type="withdraw">ì¶œê¸ˆ</button>
        </div>
      </div>

      <button class="submit" id="applyFilter">ì¡°íšŒ</button>
    </div>
  </div>

  <!-- ì„¤ì¹˜ ìœ ë„ ë²„íŠ¼(ì„ íƒ) -->
  <button id="installBtn">ì•± ì„¤ì¹˜í•˜ê¸°</button>
</div>

<script>
  /* ======================= View ì „í™˜ ======================= */
  const homeBar = document.getElementById('homeBar');
  const homeView = document.getElementById('homeView');
  const txnBar = document.getElementById('txnBar');
  const txnView = document.getElementById('txnView');
  const accountCard = document.getElementById('accountCard');
  const backBtn = document.getElementById('backBtn');

  accountCard.addEventListener('click', () => {
    homeBar.classList.add('hidden');
    homeView.classList.add('hidden');
    txnBar.classList.remove('hidden');
    txnView.classList.remove('hidden');
  });

  backBtn.addEventListener('click', () => {
    txnBar.classList.add('hidden');
    txnView.classList.add('hidden');
    homeBar.classList.remove('hidden');
    homeView.classList.remove('hidden');
  });

  /* ======================= ê±°ë˜ ë°ì´í„°(ì¶œê¸ˆ ì¤‘ì‹¬) ======================= */
  const allTxns = [
    // 2025-11
    { id: 1,  type: 'withdraw', name: 'ì£¼ì„±ê´‘', amount: 200000, date: '2025-11-06', time: '14:25:05', balance: 0 },
    { id: 2,  type: 'withdraw', name: 'ì´í¬ì§„', amount: 200000, date: '2025-11-04', time: '21:22:32', balance: 0 },
    { id: 3,  type: 'withdraw', name: 'ì´í¬ì§„', amount: 200000, date: '2025-11-03', time: '22:00:55', balance: 0 },

    // 2025-10
    { id: 4,  type: 'withdraw', name: 'ì´í¬ì§„', amount: 200000, date: '2025-10-31', time: '20:22:07', balance: 0 },
    { id: 5,  type: 'withdraw', name: 'ì£¼ì„±ê´‘', amount:  90000, date: '2025-10-30', time: '10:15:17', balance: 0 },
    { id: 6,  type: 'withdraw', name: 'ì£¼ì„±ê´‘', amount:  10000, date: '2025-10-30', time: '10:14:33', balance: 90000 },
    { id: 7,  type: 'withdraw', name: 'ì´í¬ì§„', amount: 200000, date: '2025-10-30', time: '20:25:15', balance: 0 },
    { id: 8,  type: 'withdraw', name: 'ì´í¬ì§„', amount: 200000, date: '2025-10-29', time: '18:13:15', balance: 0 },
    { id: 9,  type: 'withdraw', name: 'ì´í¬ì§„', amount: 200000, date: '2025-10-28', time: '20:51:03', balance: 0 },
    { id: 10, type: 'withdraw', name: 'ì£¼ì„±ê´‘', amount: 3620400, date: '2025-10-24', time: '10:18:31', balance: 0 },

    // 2025-10-10 (ì˜ˆì‹œ)
    { id: 11, type: 'withdraw', name: 'ì´í¬ì§„', amount: 30000, date: '2025-10-10', time: '19:34:52', balance: 0 }
  ];

  const currentBalEl = document.getElementById('currentBal');
  currentBalEl.textContent = '1,616,380ì›';

  /* ======================= í¬ë§·í„° ======================= */
  const fmtNum = (n) => n.toLocaleString('ko-KR');

  /* ======================= ê¸°ê°„/í•„í„° ìƒíƒœ ======================= */
  const filters = { period: '1week', sort: 'latest', type: 'all' };
  const periodLabel = document.getElementById('periodLabel');
  const dateRangeText = document.getElementById('dateRangeText');

  // ê¸°ì¤€ì¼(ìƒ˜í”Œ ê³ ì •)
  const BASE_DATE = new Date('2025-11-07T00:00:00');

  function getRange(period) {
    const end = new Date(BASE_DATE);
    const start = new Date(end);
    if (period === '1week')   start.setDate(end.getDate() - 7);
    if (period === '1month')  start.setMonth(end.getMonth() - 1);
    if (period === '3months') start.setMonth(end.getMonth() - 3);
    if (period === '1year')   start.setFullYear(end.getFullYear() - 1);

    const fmt = (d) => {
      const y = d.getFullYear();
      const m = String(d.getMonth()+1).padStart(2,'0');
      const dd = String(d.getDate()).padStart(2,'0');
      return `${y}.${m}.${dd}`;
    };
    return { start, end, text: `${fmt(start)} ~ ${fmt(end)}` };
  }

  function applyFilters() {
    const range = getRange(filters.period);
    dateRangeText.textContent = range.text;

    let list = allTxns.filter(t => new Date(t.date) >= range.start);
    if (filters.type !== 'all') list = list.filter(t => t.type === filters.type);

    list.sort((a,b) => {
      const da = new Date(`${a.date} ${a.time}`);
      const db = new Date(`${b.date} ${b.time}`);
      return filters.sort === 'latest' ? (db - da) : (da - db);
    });

    // ë¼ë²¨ ê°±ì‹ 
    const pLabel = { '1week':'1ì£¼ì¼','1month':'1ê°œì›”','3months':'3ê°œì›”','1year':'1ë…„' }[filters.period];
    const tLabel = { 'all':'ì „ì²´','deposit':'ì…ê¸ˆ','withdraw':'ì¶œê¸ˆ' }[filters.type];
    const sLabel = { 'latest':'ìµœì‹ ìˆœ','oldest':'ê³¼ê±°ìˆœ' }[filters.sort];
    periodLabel.textContent = `${range.text} Â· ${tLabel} Â· ${sLabel}`;

    renderTxns(list);
  }

  function renderTxns(list) {
    const holder = document.getElementById('txnList');
    if (!list.length) {
      holder.innerHTML = `<div style="padding:40px; text-align:center; color:#9aa1a9;">ê±°ë˜ë‚´ì—­ì´ ì—†ìŠµë‹ˆë‹¤</div>`;
      return;
    }
    holder.innerHTML = list.map(t => `
      <div class="item">
        <div>
          <div class="tname">${t.name}</div>
          <div class="tdate">${t.date} ${t.time}</div>
        </div>
        <div>
          <div class="tamt">-${fmtNum(t.amount)}ì›</div>
          <div class="tbal">ì”ì•¡ ${fmtNum(t.balance)}ì›</div>
        </div>
      </div>
    `).join('');
  }

  /* ======================= ëª¨ë‹¬/ì˜µì…˜ ======================= */
  const modal = document.getElementById('filterModal');
  const openFilter = document.getElementById('openFilter');
  const closeFilter = document.getElementById('closeFilter');
  const applyBtn = document.getElementById('applyFilter');

  openFilter.addEventListener('click', () => { modal.classList.add('show'); });
  closeFilter.addEventListener('click', () => { modal.classList.remove('show'); });

  // ì˜µì…˜ ë²„íŠ¼ í† ê¸€
  document.querySelectorAll('.opt-btn').forEach(btn => {
    btn.addEventListener('click', () => {
      const groupSelector =
        btn.hasAttribute('data-period') ? '[data-period]' :
        btn.hasAttribute('data-sort')   ? '[data-sort]'   :
        '[data-type]';

      document.querySelectorAll(groupSelector).forEach(b => b.classList.remove('selected'));
      btn.classList.add('selected');

      if (btn.dataset.period) { filters.period = btn.dataset.period; }
      if (btn.dataset.sort)   { filters.sort   = btn.dataset.sort; }
      if (btn.dataset.type)   { filters.type   = btn.dataset.type; }

      // ë¯¸ë¦¬ë³´ê¸° ë‚ ì§œ ë¼ë²¨ ê°±ì‹ 
      dateRangeText.textContent = getRange(filters.period).text;
    });
  });

  applyBtn.addEventListener('click', () => {
    modal.classList.remove('show');
    applyFilters();
  });

  // ì´ˆê¸° ê·¸ë¦¬ê¸°
  applyFilters();

  /* ======================= PWA: SW ë“±ë¡ & ì„¤ì¹˜ ìœ ë„(ì„ íƒ) ======================= */
  if ('serviceWorker' in navigator) {
    window.addEventListener('load', () => {
      navigator.serviceWorker.register('./service-worker.js')
        .then(() => console.log('SW ë“±ë¡ ì™„ë£Œ'))
        .catch((e) => console.log('SW ë“±ë¡ ì‹¤íŒ¨', e));
    });
  }

  // beforeinstallprompt â†’ ì„¤ì¹˜ ë²„íŠ¼ ë…¸ì¶œ (ì„ íƒ)
  let deferredPrompt = null;
  const installBtn = document.getElementById('installBtn');

  window.addEventListener('beforeinstallprompt', (e) => {
    e.preventDefault();
    deferredPrompt = e;
    installBtn.style.display = 'block';
  });

  installBtn.addEventListener('click', async () => {
    installBtn.style.display = 'none';
    if (!deferredPrompt) return;
    deferredPrompt.prompt();
    await deferredPrompt.userChoice;
    deferredPrompt = null;
  });
</script>
</body>
</html>
